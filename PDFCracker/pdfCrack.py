#!/usr/bin/env python3

from PyPDF2 import PdfFileReader

dictFile = "passwords.txt"
LockedPDF = "secret.pdf"

def analyzeZip():
    print('#######################################')
    print('    PDF Brute Force Password Tester')
    print('------------- Velivion17-------------')
    print('#######################################')
    print('')
    print('File To Crack: ' + LockedPDF)
    print('')
    getPass()

def getPass():
    print("Loading Dictionary...")
    PassList = open(dictFile, "r")
    print("Trying Combinations...")
    for line in PassList:
        password = line.rstrip()
        if(tryPass(password)):
            print('Found Password: ' + password)
            print('Extracted..')
            PassList.close()
            exit()
    print('No Password Found...')
    exit()


def tryPass(password):
    try:
        with open(LockedPDF, 'rb') as file:
            pdfObj = PdfFileReader(file)
            if pdfObj.isEncrypted:
                if(pdfObj.decrypt(password)):
                    return True
                else:
                    return False
    except:
        return False

analyzeZip()
