#!/usr/bin/env python3

from zipfile import ZipFile

dictFile = "passwords.txt"
LockedZip = "secret.zip"

def analyzeZip():
    zip = ZipFile(LockedZip)
    contents = zip.namelist()
    print('#######################################')
    print('    ZIP Brute Force Password Tester')
    print('------------- Velivion17-------------')
    print('#######################################')
    print('')
    print('File To Crack: ' + LockedZip)
    print('Files Inside Include: \n' + str(contents))
    print('')
    getPass()

def getPass():
    print("Loading Dictionary...")
    PassList = open(dictFile, "r")
    print("Trying Combinations...")
    for line in PassList:
        password = line.rstrip()
        if(tryPass(password)):
            print('Found Password: ' + password)
            print('Extracted..')
            PassList.close()
            exit()
    print('No Password Found...')
    exit()


def tryPass(password):
    try:
        with ZipFile(LockedZip) as zf:
            zf.extractall(pwd=password)
            return True

    except Exception:
        return False

analyzeZip()
